#I2c总线规范和使用说明
<br>
第六版 2014年4月4日
文件信息
关键词： I2C, I2C-bus, Standard-mode, Fast-mode, Fast-mode Plus, Fm+, Ultra Fast-mode, UFm, High Speed, Hs, inter-IC, SDA, SCL, USDA, USCL
<br>
摘要：Philips 半导体（现在是 NXP 半导体）开发了一个简单的双向2-线总线用于芯片互联高效控制。此总线称为 Inter-IC 或i2c总线。总线只需要两条信号线：一个串行数据线（SDA）和一个串行时钟线（SCL）。8位串行,双向的数据传输在标准模式下通信速度可以达到100 kbit/s，快速模式下可以达到400 kbit/s，在快速模式 Plus（Fm+）中最高可达1 Mbit/s，或在高速模式下最多可达3.4 Mbit/s。超快模式时数据单向传输，最多可达5 Mbit/s.
<br>
版本历史
第6版 2014年04月04日
第5版 2012年10月09日
第4版 2012年02月13日
第3版 2007年06月19日
第2.1版 2000年
第2版 1998年
第1版 1992年

##1 介绍
I2C-bus是一种事实上的世界标准,已经运用在50多家公司生产的超过1000多不同ICs上。此外，i2c总线还应用于各种控制体系结构中，如系统管理总线（SMBus），电源管理总线（PMBus），智能平台管理接口（IPMI），显示数据通道（DDC）和高级电信计算架构（ATCA）。
本文档帮助设备和系统设计人员了解i2c总线的工作原理并实现一个工作应用程序。描述了各种操作模式。它包含i2c总线数据传输、握手和总线仲裁方案的全面介绍。详细的章节描述了每一种操作模式下的i2c总线的时序和电气规范。
i2c兼容芯片的设计者应该使用这个文档作为参考，并确保这些新设备满足了本文档中指定的所有限制。设计包括I2C设备的系统应该检查这个文档并引用单独的组件数据表。
##2 I2C总线特性
在消费电子、电信和工业电子领域，看似毫不相关的设计往往有许多相似之处。例如，几乎每个系统都包括

 - 为了实现智能控制，通常使用单芯片的微控制器
 - 一些通用电路，如驱动LCD和LED，远程输入/输出端口，RAM，EEPROM，实时时钟或AD/DA转换器
 - 面向应用的电路，如用于无线电和视频系统，温度传感器和智能卡d 数字调谐和信号处理电路

为了利用这些相似之处，使系统设计者和设备制造商受益，同时也为了最大限度地提高硬件效率和电路的简单性，飞利浦半导体（现在的NXP半导体）开发了一种简单的双向2线总线，用于IC互联控制。该总线称为 Inter IC 或 I2C-bus。所有I2C-bus兼容设备都包含一个片上接口，允许它们通过i2c总线直接通信。这个设计概念解决了设计数字控制电路时遇到的许多接口问题。
以下是I2C总线的一些特性：

 - 只需要两条信号线;一个串行数据线（SDA）和一个串行时钟线（SCL）
 - 每个连接到总线的设备都是有一个唯一的地址。
任何时间总线只会存在简单的主/从关系（一段时期内只会有一个主机，其他全为从机）;master可以发起传输或接收数据
 - 它是一种真正的多主机总线，包括了碰撞检测和仲裁机制，以避免出现如果两个或两个以上的主同时启动数据传输时导致数据损坏。
 - 8位串行，双向的数据传输在标准模式下通信速度可以达到100 kbit/s，快速模式下可以达到400 kbit/s，在快速模式 Plus（Fm+）中最高可达1 Mbit/s，或在高速模式下最多可达3.4 Mbit/s。
 - 超快模式时数据单向传输，最多可达5 Mbit/s.
 - 在总线数据线上加入片上滤波器过滤尖峰，保持数据完整性。
 - 可以连接到同一总线的ICs的数量只受最大总线电容的限制。在某些情况下，可能放宽电容限制。参考 7.2章节
下图展示了I2C总线的典型应用。

###2.1 开发者受益
TODO:

###2.2 厂商受益
TODO:

###2.3 IC 设计者受益
TODO:

##3 I2C总线协议

###3.1 标准模式，快速模式，快速plus模式 I2C总线协议
两条线，串行数据（SDA）和串行时钟（SCL），在连接到总线的设备两者之间传递信息。每个设备都被一个唯一的地址识别（无论它是微控制器，LCD驱动，内存或是键盘接口），根据设备的功能，可以发射或接收数据。LCD模块可能只是一个接收器，而一个内存可以接收和发送数据。设备也可以扮演从设备或主设备执行数据传输（见表1）。主设备发起数据在总线上的传输并提供时钟信号，此时,被通信的设备是从设备。

术语     | 描述
-----    | ------
发送器   | 设备向总线发送数据
接收器   | 设备从总线接收数据
主设备   | 初始化传输，产生时钟信号，终止传输
从设备   | 被主设备寻址的设备
多主设备 | 多于一个可以同时控制总线且不丢失信息的主设备
同步     | 同步两个或多个设备的时钟信号的过程

I2C-bus是一种多主机总线。这意味着允许不止一个设备控制总线。主机通常是微控制器，需要考虑连接到i2c总线的两个微控制器之间的数据传输的情况

````
      MCU-A   ADC    EEPROM  LCD    MCU-B
       | |    | |    | |     | |     | |
SDA ___|_\____|_\____|_\_____|_\_____|_\______
SCL ___\______\______\_______\_______\________

```
这个例子描述了在I2C-总线上可能出现的主从和接收-发送关系。请注意，这种关系是变化的，设备的定位取决于当时数据传输的方向。数据的传输将按照以下方式进行：
1、假设MCU-A想要发送信息给MCU-B：

 - MCU-A（主机），MCU-B（从机）被寻址
 - MCU-A（主机发送），发起传输到MCU-B（从机接收）
 - MCU-A终止传输
 
2、 假设MCU-A想要接收来自MCU-B的信息：

 - MCU-A（主机），MCU-B（从机）被寻址
 - MCU-A（主机接收），发起传输到MCU-B（从机发送）
 - MCU-A终止传输

此时，MCU-A 产生时钟并终止传输。
将多个微控制器连接到i2c总线的情况意味着不止一个主机可以尝试同时启动数据传输。为了避免可能引发的混乱，需要一个仲裁程序。这个需要所有连接到I2C总线的I2C接口进行“线-与”联接。
如果两个或两个以上的主机尝试在总线上通信，第一个会产生一个“one”，另一种则产生“zero”失去仲裁。
仲裁期间的时钟信号是由主机产生的时钟的同步组合使用“线-与”连接到SCL信号线。（关于仲裁的更详细的信息请看3.1.8章节）
在i2c总线上生成时钟信号始终是主机的责任;
当在总线上传输数据时，每个主机都会生成自己的时钟信号。
只有当一个主机被一个缓慢的从装置拉低了时钟线，或者当仲裁发生时，主机的I2C总线时钟信号才会改变。
表2 总结了I2C总线系统特性的规范要求，包括了强制和可选部分
Table 2 i2c总线协议特性的要求
M = 强制; O = 可选; n/a = 不适用

| 特性  | 配置|||
|----|----|----|----|
||单总机|多总机 |从机|
|启动状态 | M | M | M |
|结束状态 | M | M | M |
|应答     | M | M | M |
|同步     |n/a| M |n/a|
|仲裁     |n/a| M |n/a|
|时钟展宽 | O | O | O |
|7位从地址| M | M | M |
|10位从地址|O | O | O |
|广播地址 | O | O | O |
|软件复位 | O | O | O |
|起始字节 |n/a| O |n/a|
|设备ID   |n/a|n/a| O |

###3.1.1 SDA和SCL信号
TODO:
##4 I2C通信协议的其他使用

##5 总线速度

##6 电气特性和时序

##7 I2C总线设备到总线的电气连接

##8 缩略语表

##9 法律信息

##10 目录
